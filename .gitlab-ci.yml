
build-back:
  image: maven:3.8.1-jdk-11-slim
  stage: build
  script:
    - cd api
    - mvn clean package -Dmaven.test.skip=true
  artifacts:
    paths:
      - api/target/tlcdemoApp-1.0.0-SNAPSHOT.jar
    expire_in: 1 week

#build-front:
#  image: node:10-alpine
#  stage: build
#  script:
#    - cd front
#    - npm install
#    - npm run ng build

test-back:
  image: maven:3.8.1-jdk-11-slim
  stage: test
  services:
    - mysql
  variables:
    MYSQL_ROOT_PASSWORD: root
    MYSQL_DATABASE: tlc
    MYSQL_USER: tlc
    MYSQL_PASSWORD: tlc
  script:
    - apt-get update
    - apt-get -y install mysql-client
    - cd api
    - mysql --host=mysql --user=tlc --password=tlc tlc < src/main/resources/db/migration/V1__Initial_version.sql
    - mvn clean test


#test-front:
#  image: node:10-alpine
#  stage: test
#  script:
#    - cd front
#    - npm install
#    - npm run ng test
